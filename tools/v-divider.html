<HTML>
<HEAD >
<TITLE>The Best Voltage Divider Calculator Ever</TITLE>
<meta name="author" content="Dan White">
<!-- original version from:
    http://www.ti.com/download/kbase/volt/volt_div3.htm
    highly modified since then
-->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116248682-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "UA-116248682-1");
</script>


<meta name="viewport" content="width=device-width, initial-scale=1.0">


<style>
body {
  font-family: sans-serif;
}
.heading {
  font-weight: bold;
}
.input {
  font-size: larger;
  font-weight: bold;
}
.result {
    background-color: #ffffcc;
    font-family: monospace;
}
#vdivider-results th {
  text-align: center;
  width: 10ex;
}
#vdivider-results tr:nth-child(even) {
  background-color: #ffffee;
}
#vdivider-results td {
  text-align: right;
  white-space: nowrap;
}
</style>

<SCRIPT Language=JavaScript>
function calculate1() {
  seq = parseFloat(document.vdivider.seq.value);
  if (seq==96) { doe96(); }
  if (seq==24) { doe24(); }
  if (seq==12) { doe12(); }
  if (seq==6) { doe6(); }
  if (seq==3) { doe3(); }
}

function doe96() {
  res1 = new Array (0.1, 0.102, 0.105, 0.107, 0.11, 0.113, 0.115, 0.118, 0.121,
    0.124, 0.127, 0.13, 0.133, 0.137, 0.14, 0.143, 0.147, 0.15, 0.154, 0.158,
    0.162, 0.165, 0.169, 0.174, 0.178, 0.182, 0.187, 0.191, 0.196, 0.2, 0.205,
    0.21, 0.215, 0.221, 0.226, 0.232, 0.237, 0.243, 0.249, 0.255, 0.261, 0.267,
    0.274, 0.28, 0.287, 0.294, 0.301, 0.309, 0.316, 0.324, 0.332, 0.34, 0.348,
    0.357, 0.365, 0.374, 0.383, 0.392, 0.402, 0.412, 0.422, 0.432, 0.442,
    0.453, 0.464, 0.475, 0.487, 0.499, 0.511, 0.523, 0.536, 0.549, 0.562,
    0.576, 0.59, 0.604, 0.619, 0.634, 0.649, 0.665, 0.681, 0.698, 0.715, 0.732,
    0.75, 0.768, 0.787, 0.806, 0.825, 0.845, 0.866, 0.887, 0.909, 0.931, 0.953,
    0.976, 1, 1.02, 1.05, 1.07, 1.1, 1.13, 1.15, 1.18, 1.21, 1.24, 1.27, 1.3,
    1.33, 1.37, 1.4, 1.43, 1.47, 1.5, 1.54, 1.58, 1.62, 1.65, 1.69, 1.74, 1.78,
    1.82, 1.87, 1.91, 1.96, 2, 2.05, 2.1, 2.15, 2.21, 2.26, 2.32, 2.37, 2.43,
    2.49, 2.55, 2.61, 2.67, 2.74, 2.8, 2.87, 2.94, 3.01, 3.09, 3.16, 3.24,
    3.32, 3.4, 3.48, 3.57, 3.65, 3.74, 3.83, 3.92, 4.02, 4.12, 4.22, 4.32,
    4.42, 4.53, 4.64, 4.75, 4.87, 4.99, 5.11, 5.23, 5.36, 5.49, 5.62, 5.76,
    5.9, 6.04, 6.19, 6.34, 6.49, 6.65, 6.81, 6.98, 7.15, 7.32, 7.5, 7.68, 7.87,
    8.06, 8.25, 8.45, 8.66, 8.87, 9.09, 9.31, 9.53, 9.76, 10, 10.2, 10.5, 10.7,
    11, 11.3, 11.5, 11.8, 12.1, 12.4, 12.7, 13, 13.3, 13.7, 14, 14.3, 14.7, 15,
    15.4, 15.8, 16.2, 16.5, 16.9, 17.4, 17.8, 18.2, 18.7, 19.1, 19.6, 20, 20.5,
    21, 21.5, 22.1, 22.6, 23.2, 23.7, 24.3, 24.9, 25.5, 26.1, 26.7, 27.4, 28,
    28.7, 29.4, 30.1, 30.9, 31.6, 32.4, 33.2, 34, 34.8, 35.7, 36.5, 37.4, 38.3,
    39.2, 40.2, 41.2, 42.2, 43.2, 44.2, 45.3, 46.4, 47.5, 48.7, 49.9, 51.1,
    52.3, 53.6, 54.9, 56.2, 57.6, 59, 60.4, 61.9, 63.4, 64.9, 66.5, 68.1, 69.8,
    71.5, 73.2, 75, 76.8, 78.7, 80.6, 82.5, 84.5, 86.6, 88.7, 90.9, 93.1, 95.3,
    97.6);
  res2 = new Array (1, 1.02, 1.05, 1.07, 1.1, 1.13, 1.15, 1.18, 1.21,
      1.24, 1.27, 1.3, 1.33, 1.37, 1.4, 1.43, 1.47, 1.5, 1.54, 1.58, 1.62,
      1.65, 1.69, 1.74, 1.78, 1.82, 1.87, 1.91, 1.96, 2, 2.05, 2.1, 2.15, 2.21,
      2.26, 2.32, 2.37, 2.43, 2.49, 2.55, 2.61, 2.67, 2.74, 2.8, 2.87, 2.94,
      3.01, 3.09, 3.16, 3.24, 3.32, 3.4, 3.48, 3.57, 3.65, 3.74, 3.83, 3.92,
      4.02, 4.12, 4.22, 4.32, 4.42, 4.53, 4.64, 4.75, 4.87, 4.99, 5.11, 5.23,
      5.36, 5.49, 5.62, 5.76, 5.9, 6.04, 6.19, 6.34, 6.49, 6.65, 6.81, 6.98,
      7.15, 7.32, 7.5, 7.68, 7.87, 8.06, 8.25, 8.45, 8.66, 8.87, 9.09, 9.31,
      9.53, 9.76);
  e = 96;
  sigfigs = 3;
  calculate2();
  }

function doe24() {
  res1 = new Array (0.1, 0.11, 0.12, 0.13, 0.15, 0.16, 0.18, 0.2, 0.22, 0.24,
    0.27, 0.3, 0.33, 0.36, 0.39, 0.43, 0.47, 0.51, 0.56, 0.62, 0.68, 0.75,
    0.82, 0.91, 1.0, 1.1, 1.2, 1.3, 1.5, 1.6, 1.8, 2.0, 2.2, 2.4, 2.7, 3.0,
    3.3, 3.6, 3.9, 4.3, 4.7, 5.1, 5.6, 6.2, 6.8, 7.5, 8.2, 9.1, 10, 11, 12, 13,
    15, 16, 18, 20, 22, 24, 27, 30, 33, 36, 39, 43, 47, 51, 56, 62, 68, 75, 82,
    91);
  res2 = new Array (1.0, 1.1, 1.2, 1.3, 1.5, 1.6, 1.8, 2.0, 2.2, 2.4,
      2.7, 3.0, 3.3, 3.6, 3.9, 4.3, 4.7, 5.1, 5.6, 6.2, 6.8, 7.5, 8.2, 9.1);
  e = 24;
  sigfigs = 2;
  calculate2();
  }

function doe12() {
  res1 = new Array (0.1, 0.12, 0.15, 0.18, 0.22, 0.27, 0.33, 0.39, 0.47, 0.56,
    0.68, 0.82, 1.0, 1.2, 1.5, 1.8, 2.2, 2.7, 3.3, 3.9, 4.7, 5.6, 6.8, 8.2, 10,
    12, 15, 18, 22, 27, 33, 39, 47, 56, 68, 82);
  res2 = new Array (1.0, 1.2,
      1.5, 1.8, 2.2, 2.7, 3.3, 3.9, 4.7, 5.6, 6.8, 8.2);
  e = 12;
  sigfigs = 2;
  calculate2();
  }

function doe6() {
  res1 = new Array (0.1, 0.15, 0.22, 0.33, 0.47, 0.68, 1.0, 1.5, 2.2, 3.3, 4.7,
    6.8, 10, 15, 22, 33, 47, 68);
  res2 = new Array (1.0, 1.5, 2.2, 3.3, 4.7,
      6.8);
  e = 6;
  sigfigs = 2;
  calculate2();
  }

function doe3() {
  res1 = new Array (0.1, 0.22, 0.47, 1.0, 2.2, 4.7, 10, 22, 47);
  res2 = new Array (1.0, 2.2, 4.7);
  e = 3;
  sigfigs = 2;
  calculate2();
  }

function f2s(n, precision=2, width=5, plus=false) {
  if (precision > 0) {
    s = n.toFixed(precision);
  } else {
    var x = Math.pow(10, precision);
    var nn = Math.round(n * x) / x;
    s = nn.toFixed(0);
  }
  if (plus && s >= 0) {
    s = "+" + s;
  }
  while (s.length < width) {  // pad with leading spaces
          s = " " + s;
  }
  return s;
}

function f2eng(x, figs=sigfigs) {
  // TODO: handle numbers < 1.0
  var siMap = {
    "-4":"p",
    "-3":"n",
    "-2":"&mu;",
    "-1":"m",
    "0": "&nbsp;",
    "1":"k",
    "2":"M",
    "3":"G",
    "4":"T"
  };
  var scale = Math.log10(x);
  var digits = Math.ceil(scale);
  if (digits == scale) { digits = digits + 1; }  // compensate for 1000 -> 1k
  var prefix = Math.floor(digits / 3);
  var rem = Math.round(digits % 3);
  if (rem == 0) {  // compensate for 1000 -> 1k
    prefix = prefix - 1;
    rem = 1;
  }
  var eng_digits = digits - 3*prefix;  // digits left of decimal
  var num = x / Math.pow(10, 3*prefix);
  var s = f2s(num, precision=(figs-eng_digits), width=5) + siMap[prefix.toString()];
  return s;
}



function sorter(r, method) {
  switch (method) {
    case "abserr":
      // lowest abs(error)
      r.sort(
        function(a, b) {
          return Math.abs(a.err) - Math.abs(b.err);
        }
      );
      break;

    case "err":
      // signed error
      r.sort(
        function(a, b) {
          return (b.err - a.err);
        }
      );
      break;

    case "r":
      // resistance, all values (sum, parallel, r1, r2) scale together
      r.sort(
        function(a, b) {
          return (a.r1 - b.r1);
        }
      );
      break;
  }
  return r;
}




function clear1() {
  table = document.getElementById("vdivider-results");
  rows = table.getElementsByClassName("result");
  while (rows[0]) {
    rows[0].parentNode.removeChild(rows[0]);
  }
}

function  calculate2() {
  clear1()
  var i, j, seed, error, input_voltage, output_voltage, test_ratio, tol;

  input_voltage = parseFloat(document.vdivider.input_voltage.value)
  output_voltage = parseFloat(document.vdivider.output_voltage.value)
  sortby = document.vdivider.sortby.value;
  seed = parseFloat(document.vdivider.seed.value)

  tol = 0.5 * (Math.pow(10, 1/e) - 1);

  ratio = output_voltage / input_voltage

  // limitation of this calculator:
  // constrain resistor ratio to less than 2 decades
  // TODO: give indication of expected variance of the result
  if ((input_voltage / output_voltage <= 1.009) ||
      (input_voltage / output_voltage >= 100 && e == 96) ||
      (input_voltage / output_voltage >= 93 && e == 24) ||
      (input_voltage / output_voltage >= 84 && e == 12) ||
      (input_voltage / output_voltage >= 70 && e == 6) ||
      (input_voltage / output_voltage >= 49 && e == 3)) {
    // alert ("Voltage ratio too high");
    return;
  }

  var candidates = [];
  for (i = 0; i < res1.length; i++) {
    for (j = 0; j < res2.length; j++) {
      test_ratio = res2[j] / (res1[i] + res2[j]);
      err = (test_ratio / ratio) - 1.0

      if (Math.abs(err) <= tol) {
        x = {r1: res1[i], r2: res2[j], err: err};
        candidates.push(x)
      }
    }
  }

  // Only keep the 2*e smallest abs(err) values
  candidates = sorter(candidates, "abserr");
  numrows = Math.min(candidates.length, 2*e);
  results = candidates.slice(0, numrows);

  // then sort by the requested metric
  results = sorter(results, sortby);

  // build the table
  table = document.getElementById("vdivider-results");

  for (var i = 0; i < numrows; i++) {
    row = table.insertRow(table.rows.length);
    row.className = "result";

    var cell = row.insertCell(row.length);
    n = results[i].r1 * seed;
    cell.innerHTML = f2eng(n);

    cell = row.insertCell(row.length);
    n = results[i].r2 * seed;
    cell.innerHTML = f2eng(n);

    cell = row.insertCell(row.length);
    n = results[i].err * 100;
    cell.innerHTML = f2s(n, 3, 7, plus=true);

    cell = row.insertCell(row.length);
    n = (results[i].r1 + results[i].r2)* seed;
    cell.innerHTML = f2eng(n, figs=(sigfigs + 1));

    cell = row.insertCell(row.length);
    n = input_voltage / ((results[i].r1 + results[i].r2)* seed);
    cell.innerHTML = f2eng(n, figs=(sigfigs + 1));

    cell = row.insertCell(row.length);
    n = seed / (1.0 / (results[i].r1) + 1.0 / (results[i].r2));
    cell.innerHTML = f2eng(n, figs=(sigfigs + 1));
  }
}
</SCRIPT>

</HEAD>
<BODY>
<h1>The Best Voltage Divider Calculator Ever*</h1>

Find the best set of resistors for a voltage divider given the desired ratio.

<pre>
V<sub>end</sub> &boxvr;&boxh;&boxh;&lt;R<sub>top</sub>&gt;&boxh;&boxh;V<sub>mid</sub>&boxh;&boxh;&lt;R<sub>bot</sub>&gt;&boxh;&boxh;&boxvl; 0 V
          &gt;&boxh;&boxh;&boxh;&boxh;I<sub>total</sub>&boxh;&boxh;&boxh;&boxh;&gt;
</pre>

<TABLE id=vdivider cellSpacing=0 cellPadding=1 border=1 BGCOLOR="#ffffcc">
<TR><TD>
<FORM name=vdivider>
<TABLE cellSpacing=0 cellPadding=3 border=0>
<tr>
    <td align=right><span class="input">V<sub>end</sub></span></td>
  <td><input autofocus name=input_voltage type=number onchange="calculate1()" value=""></td>
</tr>
<tr>
  <td align=right><span class="input">V<sub>mid</sub></span></td>
  <td><input name=output_voltage type=number onchange="calculate1()" value=""></td>
</tr>
<tr>
  <td align=right><span class="input">Precision</span></td>
  <td>
  <select name="seq" onchange="calculate1()">
  <option value="96">E96 (1%)</option>
  <option value="24">E24 (5%)</option>
  <option selected value="12">E12 (10%)</option>
  <option value="6">E6 (20%)</option>
  <option value="3">E3 (&gt;20%)</option>
  </td>
</tr>
<tr><td align=right><span class="input">Scale</span></td>
  <td>
  <select name=seed onchange="calculate1()">
  <option value="1">1</option>
  <option value="10">10</option>
  <option value="100">100</option>
  <option selected value="1000">1k</option>
  <option value="10000">10k</option>
  <option value="100000">100k</option>
  <option value="1000000">1M</option>
  </select>
  </td>
</tr>
<tr><td align=right><span class="input">Sort by</span></td>
  <td> <input type="radio" name="sortby" onchange="calculate1()" checked value="abserr">abs(error)
  <input type="radio" name="sortby" onchange="calculate1()" value="err">&pm;error
  <input type="radio" name="sortby" onchange="calculate1()" value="r">R
  </td>
</tr>
<tr><td>&nbsp;</td><td><input type=button value="Calculate" onclick=calculate1()></td></tr>
</table>
</FORM>

<table id="vdivider-results">
<tr>
  <th><span class="heading">R<sub>top</sub></th>
  <th><span class="heading">R<sub>bot</sub></th>
  <th><span class="heading">% Error</span></th>
  <th><span class="heading">R<sub>total</sub></span></th>
  <th><span class="heading">I<sub>total</sub></span></th>
  <th><span class="heading">R<sub>||</sub></span></th>
</tr>
</table>
</td></TR></TABLE>

</center>

<br>
* Really, I couldn't find one of the bajillions out there that I would
recommend to students that were quick to
use and displayed the information needed when finding resistor values in an
electronics design.
So I modified one to match my desires.

<br>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">The best voltage divider calculator ever</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://github.com/etihwnad" property="cc:attributionName" rel="cc:attributionURL">Dan White</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>

</BODY>
</HTML>

<!-- vim: sw=2 sts=2
-->
